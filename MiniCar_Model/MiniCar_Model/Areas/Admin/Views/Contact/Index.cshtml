@model List<Contact>

@{
  ViewData["Title"] = "Quản lý liên hệ";
}

<section id="main-content">
  <section class="wrapper">
    <h3><i class="fa fa-angle-right"></i> Liên hệ</h3>

    <div class="row mt">
      <div class="col-md-12">
        <div class="content-panel">
          <div style="padding: 15px;">
            <div class="row">
              <div class="col-md-4 col-sm-12">
                <h4 style="margin-bottom: 15px;">
                  <i class="fa fa-angle-right"></i> Danh sách
                </h4>
              </div>
              <div class="col-md-8 col-sm-12 text-right">
                <div class="form-group" style="display: flex; gap: 5px; flex-wrap: wrap;">
                  <input type="text"
                         class="form-control"
                         placeholder="Tìm kiếm liên hệ..."
                         style="flex: 1; min-width: 200px;" />

                  <button class="btn btn-primary">
                    <i class="fa fa-search"></i>
                    <span class="hidden-xs">Tìm kiếm</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <hr style="margin: 0;" />

          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th class="text-center">#</th>
                  <th>Tên</th>
                  <th>Email</th>
                  <th>Tiêu đề</th>
                  <th class="text-center">Trạng thái</th>
                  <th class="text-center">Ngày gửi</th>
                  <th class="text-center">Hành động</th>
                </tr>
              </thead>
              <tbody>
                @if (Model != null && Model.Any()) {
                  int index = 1;
                  foreach (var contact in Model) {
                    <tr>
                      <td class="text-center">@index</td>
                      <td>@contact.Name</td>
                      <td>@contact.Email</td>
                      <td>@contact.Subject</td>

                      <td class="text-center">
                        @switch (contact.StatusContact) {
                          case "Pending":
                          <span class="label label-warning label-mini">Chờ xử lý</span>
                          break;
                          case "Read":
                          <span class="label label-info label-mini">Đã đọc</span>
                          break;
                          case "InProgress":
                          <span class="label label-primary label-mini">Đang xử lý</span>
                          break;
                          case "Replied":
                          <span class="label label-success label-mini">Đã phản hồi</span>
                          break;
                          case "Closed":
                          <span class="label label-default label-mini">Đã đóng</span>
                          break;
                          case "Spam":
                          <span class="label label-danger label-mini">Spam</span>
                          break;
                          case "Rejected":
                          <span class="label label-danger label-mini">Từ chối</span>
                          break;
                        }
                      </td>


                      <td class="text-center">
                        @contact.CreatedAt?.ToString("dd/MM/yyyy HH:mm")
                      </td>

                      <td class="text-center" style="white-space: nowrap;">
                        <a asp-area="Admin"
                           asp-controller="Contact"
                           asp-action="Edit"
                           asp-route-id="@contact.ContactId"
                           class="btn btn-primary btn-xs">
                          <i class="fa fa-pencil"></i> Cập nhật
                        </a>

                        <a href="javascript:void(0)"
                           class="btn btn-danger btn-xs"
                           onclick="showConfirmDelete(
                                                           '@contact.ContactId',
                                                           'Liên hệ của @contact.Name',
                                                           '@Url.Action("Delete", "Contact", new { area = "Admin" })'
                                                   )">
                          <i class="fa fa-trash-o"></i> Xóa
                        </a>
                      </td>
                    </tr>
                    index++;
                  }
                } else {
                  <tr>
                    <td colspan="7" class="text-center text-muted">
                      Không có liên hệ nào
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>

        <!-- pagination giả giống Bill -->
        <div class="text-center" style="margin-top: 20px;">
          @await Html.PartialAsync("_PaginationPartial") 
        </div>

      </div>
    </div>
  </section>
</section>

@await Html.PartialAsync("_ConfirmDeleteModal")
