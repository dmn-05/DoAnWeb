@model IEnumerable<MiniCar_Model.Models.Category>
@{
	ViewData["title"] = "Quản lý Loại sản phẩm";
}

<section id="main-content">
	<section class="wrapper">
		<h3><i class="fa fa-angle-right"></i> Loại sản phẩm</h3>

		<div class="row mt">
			<div class="col-md-12">
				<div class="content-panel">
					<div style="padding: 15px;">
						<div class="row">
							<div class="col-md-4 col-sm-12">
								<h4 style="margin-bottom: 15px;"><i class="fa fa-angle-right"></i> Danh sách</h4>
							</div>
							<div class="col-md-8 col-sm-12 text-right">
								<form asp-action="Index" method="get" class="form-group" style="display: flex; gap: 5px; flex-wrap: wrap;">
									<input type="text" name="searchString" value="@ViewBag.SearchString" class="form-control"
												 placeholder="Tìm kiếm loại sản phẩm..." style="flex: 1; min-width: 200px;" />
									<button type="submit" class="btn btn-primary">
										<i class="fa fa-search"></i>
									</button>
									<a asp-action="Index" class="btn btn-default" title="Làm mới"><i class="fa fa-refresh"></i></a>
									<a asp-action="Create" class="btn btn-success">
										<i class="fa fa-plus"></i> <span class="hidden-xs">Thêm loại sản phẩm</span>
									</a>
								</form>
							</div>
						</div>
					</div>

					<hr style="margin: 0;" />

					<div class="table-responsive">
						<table class="table table-hover">
							<thead>
								<tr>
									<th class="text-center">#</th>
									<th>Mã loại</th>
									<th>Mã loại cha</th>
									<th>Tên loại sản phẩm</th>
									<th class="text-center">Trạng thái</th>
									<th class="text-center">Hành động</th>
								</tr>
							</thead>
							<tbody>
								@{
									int i = 1;
								}
								@foreach (var item in Model)
								{
									<tr>
										<td class="text-center">@i</td>
										<td><small>CAT-@item.CategoryId</small></td>
										<td>@(item.ParentId != null ? "PAR-" + item.ParentId : "N/A")</td>
										<td><strong>@item.NameCategory</strong></td>
										<td class="text-center">
											@if (item.StatusCategory?.Trim().ToUpper() == "ACTIVE")
											{
												<span class="label label-success label-mini">ACTIVE</span>
											}
											else
											{
												<span class="label label-danger label-mini">INACTIVE</span>
											}
										</td>
										<td class="text-center" style="white-space: nowrap;">
											<a asp-action="Edit" asp-route-id="@item.CategoryId" class="btn btn-primary btn-xs">
												<i class="fa fa-pencil"></i> Sửa
											</a>

											<form asp-action="ChangeStatus" asp-route-id="@item.CategoryId" method="post" style="display:inline;">
												<button type="submit" class="btn btn-danger btn-xs" onclick="return confirm('Bạn có chắc chắn muốn đổi trạng thái loại sản phẩm này?')">
													<i class="fa fa-trash-o"></i>
													@(item.StatusCategory?.Trim().ToUpper() == "ACTIVE" ? "Khóa" : "Mở")
												</button>
											</form>
										</td>
									</tr>
									i++;
								}
							</tbody>
						</table>
					</div>
				</div>

				<div class="text-center" style="margin-top: 20px;">
					<ul class="pagination">
						@* Nút Quay lại (Previous) *@
						<li class="page-item @(ViewBag.CurrentPage <= 1 ? "disabled" : "")">
							<a class="page-link" asp-route-page="@(ViewBag.CurrentPage - 1)" asp-route-searchString="@ViewBag.SearchString">«</a>
						</li>

						@* Hiển thị danh sách số trang *@
						@for (int dem = 1; dem <= ViewBag.TotalPages; dem++)
						{
							<li class="page-item @(dem == ViewBag.CurrentPage ? "active" : "")">
								<a class="page-link" asp-route-page="@dem" asp-route-searchString="@ViewBag.SearchString">@dem</a>
							</li>
						}

						@* Nút Tiếp theo (Next) *@
						<li class="page-item @(ViewBag.CurrentPage >= ViewBag.TotalPages ? "disabled" : "")">
							<a class="page-link" asp-route-page="@(ViewBag.CurrentPage + 1)" asp-route-searchString="@ViewBag.SearchString">»</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</section>
</section>