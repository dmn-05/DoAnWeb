@{
	ViewData["Title"] = "Chi Tiết Sản Phẩm";
}
@model ProductDetailVM

<!-- back to top button-->
<a href="#" class="cd-top">Back To Top</a>
<!--End Back to top button-->
<!-- Start Banner Area -->
<section class="banner-area organic-breadcrumb">
	<div class="container">
		<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
			<div class="col-first">
				<h1>Chi tiết sản phẩm</h1>
				<nav class="d-flex align-items-center">
					<a asp-controller="Home" asp-action="Index">Trang chủ<span class="lnr lnr-arrow-right"></span></a>
					<a asp-controller="Product" asp-action="List">>Danh sách sản phẩm<span class="lnr lnr-arrow-right"></span></a>
					<a asp-controller="Product" asp-action="Detail">chi tiết sản phẩm</a>
				</nav>
			</div>
		</div>
	</div>
</section>
<!-- End Banner Area -->
<!--================Single Product Area =================-->
<div class="product_image_area">
	<div class="container">
		<div class="row s_product_inner">
			<div class="col-lg-6">
				<div class="s_Product_carousel owl-carousel">

					@foreach (var img in Model.Images)
					{
						<div class="single-prd-item
	                d-flex
	                align-items-center
	                justify-content-center">

							<img src="/@img.UrlImage"
									 class="img-fluid product-img"
									 alt="@Model.Product.NameProduct" />
						</div>
					}

				</div>

			</div>
			<div class="col-lg-5 offset-lg-1">
				<div class="s_product_text">
					<h3>@Model.Product.NameProduct</h3>
					<h2 id="price">@Model.Price.ToString("N0") đ</h2>
					<ul class="list">
						<li><a ><span>Thương hiệu</span> : @Model.Product.Trademark?.NameTrademark</a></li>
						<li><a class="active" asp-controller="Category" asp-action="Index"><span>Phân loại</span> : @Model.Product.Category?.NameCategory</a></li>
            <li>
              <a >
								<span>Số lượng tồn</span> :
								<span id="stock-count" class="ml-2 text-success">
                  @Model.Quanlity
                </span>
              </a>
            </li>
						<li>
							<a>
								<span>Tình trạng</span> :
								<span id="stock-status"
											class="@(Model.Quanlity > 0 ? "text-success" : "text-danger")">
									@(Model.Quanlity > 0 ? "Còn hàng" : "Hết hàng")
								</span>
								
							</a>
						</li>
					</ul>
					<p>
						@Model.Product.Descriptions
					</p>
					<div class="noname align-items-center">
						<div class="pb-2"><label>Chọn phiên bản:</label></div>
						<div class="default-select pb-2">
							<select id="variantSelect">
								@foreach (var v in Model.Variants)
								{
									<option value="@v.VariantId">
										@v.Size.Scale - @v.Color.ColorName
									</option>
								}
							</select>
						</div>
					


						<div class="pb-1 pt-2"><label for="qty">Số lượng:</label></div>
						<div class="product_count">

							<input type="text" name="qty" id="sst" maxlength="12" value="1" title="Quantity:" class="input-text qty">
							<button onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst )) result.value++;return false;"
											class="increase items-count" type="button">
								<i class="lnr lnr-chevron-up"></i>
							</button>
							<button onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst ) &amp;&amp; sst > 0 ) result.value--;return false;"
											class="reduced items-count" type="button">
								<i class="lnr lnr-chevron-down"></i>
							</button>
						</div>
					</div>
					<br>
					<div class="card_area d-flex align-items-center">
						<a class="primary-btn" href="#">Thêm vào giỏ hàng</a>
						@if (Model.IsLoggedIn)
						{
							<a class="icon_btn" href="#" title="Wishlist">
								<i class="lnr lnr lnr-heart"></i>
							</a>
						}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!--================End Single Product Area =================-->
<!--================Product Description Area =================-->
<section class="product_description_area">
	<div class="container">
		<ul class="nav nav-tabs" id="myTab" role="tablist">
			<li class="nav-item">
				<a class="nav-link" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Mô tả sản phẩm</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
					 aria-selected="false">Chính sách đổi trả</a>
			</li>
			<li class="nav-item">
				<a class="nav-link active" id="review-tab" data-toggle="tab" href="#review" role="tab" aria-controls="review"
					 aria-selected="false">Nhận xét</a>
			</li>
		</ul>
		<div class="tab-content" id="myTabContent">
			<div class="tab-pane fade" id="home" role="tabpanel" aria-labelledby="home-tab">
				<p>
					@Model.Product.Descriptions
				</p>

			</div>
			<div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
				<div class="policy-content p-3">

					<p>
						<b>1. Quy định chung</b><br>
						Tại <b>Minicar</b>, chúng tôi cam kết mang đến những sản phẩm mô hình chất lượng nhất. Tuy nhiên, nếu sản phẩm gặp lỗi từ nhà sản xuất hoặc hư hỏng trong quá trình vận chuyển, chúng tôi sẵn sàng hỗ trợ đổi trả theo quy định.
					</p>

					<p>
						<u><b>Điều kiện đổi trả:</b></u> <br>
						* Sản phẩm còn nguyên bao bì, hộp và các phụ kiện đi kèm (nếu có).<br>
						* Sản phẩm chưa qua sử dụng, không có dấu hiệu tháo lắp hoặc can thiệp kỹ thuật.<br>
						* Có hóa đơn mua hàng hoặc thông tin đơn hàng trên hệ thống.
					</p>

					<p>
						<b>2. Thời hạn đổi trả</b><br>
						* <b>Lỗi do nhà sản xuất (Sơn, chi tiết lắp ráp):</b> Đổi mới trong vòng 03 ngày kể từ khi nhận hàng.<br>
						* <b>Hư hỏng do vận chuyển (Gãy, vỡ):</b> Quý khách vui lòng phản hồi ngay trong vòng 24h sau khi nhận hàng (kèm video mở hộp).
					</p>

					<p>
						<b>3. Chi phí vận chuyển cho việc đổi hàng</b><br>
						* <b>Hàng lỗi/Giao sai mẫu:</b> Minicar chịu 100% phí vận chuyển hai chiều.<br>
						* <b>Đổi theo nhu cầu (Đổi mẫu/size):</b> Khách hàng thanh toán phí vận chuyển hai chiều và chênh lệch giá trị sản phẩm (nếu có).
					</p>

					<p>
						<b>4. Địa chỉ và Thông tin liên hệ</b><br>
						Để thực hiện đổi trả, quý khách vui lòng liên hệ hoặc gửi hàng về:<br>
						<b>Email:</b> minicarmodel@gmail.com<br>
						<b>Hotline tư vấn:</b> 0333854516<br>
						<b>Website:</b> www.minicar.com.vn<br>
						<b>Facebook:</b> www.facebook.com/minicar
					</p>

					<p>
						<b>5. Thời gian xử lý</b><br>
						Sau khi nhận được hàng gửi về, Minicar sẽ kiểm tra và thực hiện gửi lại sản phẩm mới hoặc hoàn tiền trong vòng <b>3 - 5 ngày làm việc</b>.
					</p>

					<p><i>* Lưu ý: Đối với các sản phẩm mô hình phiên bản giới hạn (Limited), việc đổi hàng sẽ tùy thuộc vào tình trạng tồn kho thực tế.</i></p>
				</div>
			</div>
			<div class="tab-pane fade show active" id="review" role="tabpanel" aria-labelledby="review-tab">
				<div class="row">
					<div class="col-lg-6">
						<div class="row total_rate">
							<div class="col-6">
								<div class="box_total">
									<h5>Đánh giá sản phẩm</h5>
									<h4>@Model.AvgRating.ToString("0.0")</h4>
									<h6>(@Model.Comments.Count Nhận xét)</h6>
								</div>
							</div>
							<div class="col-6">
								<div class="rating_list">
									<h3>Dựa trên 3 đánh giá</h3>
									<ul class="list">
										<li>
											<a href="#">
												5 sao <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 01
											</a>
										</li>
										<li>
											<a href="#">
												4 sao <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 01
											</a>
										</li>
										<li>
											<a href="#">
												3 sao <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 01
											</a>
										</li>
										<li>
											<a href="#">
												2 sao <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 01
											</a>
										</li>
										<li>
											<a href="#">
												1 sao <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 01
											</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="review_list">
							@if (!Model.Comments.Any())
							{
								<p class="text-center">Chưa có bình luận nào</p>
							}
							else
							{
								foreach (var c in Model.Comments)
								{
									<div class="review_item">
										<div class="media">
											<div class="d-flex">
												<img src="~/img/product/default-user.png" alt="" >
											</div>
											<div class="media-body">
												<h4>@c.Account?.UserName ?? "Ẩn danh"</h4>

												@for (int i = 1; i <= 5; i++)
												{
													<i class="fa fa-star" style="color:@(i <= c.Rating ? "#ffcc00" : "#ccc")"></i>
												}
											</div>
										</div>
										<p>@c.Content</p>
									</div>
								}
							}
						</div>
          </div>						
					<div class="col-lg-6">
            <div class="review_box">
              <h4>Thêm nhận xét mới</h4>
              <p>Đánh giá của bạn:</p>
              <ul class="list">
                <li><a href="#"><i class="fa fa-star"></i></a></li>
                <li><a href="#"><i class="fa fa-star"></i></a></li>
                <li><a href="#"><i class="fa fa-star"></i></a></li>
                <li><a href="#"><i class="fa fa-star"></i></a></li>
                <li><a href="#"><i class="fa fa-star"></i></a></li>
              </ul>
              <p>Tuyệt vời</p>
              <form class="row contact_form" action="contact_process.php" method="post" id="contactForm" novalidate="novalidate">

                <div class="col-md-12">
                  <div class="form-group">
                    <textarea class="form-control" name="message" id="message" rows="1" placeholder="Nhận xét" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Review'"></textarea>
                  </div>
                </div>
                <div class="col-md-12 text-right">
                  <button type="submit" value="submit" class="primary-btn">Đánh giá ngay</button>
                </div>
              </form>
            </div>
          </div>
				</div>
			</div>
		</div>
	</div>
</section>
<!--================End Product Description Area =================-->
<!-- Start related-product Area -->
<section class="related-product-area section_gap py-2">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-lg-6 text-center">
				<div class="section-title">
					<h1>Danh sách sản phẩm liên quan</h1>
				</div>
			</div>
		</div>

		@if (Model.RelatedProducts.Any())
		{
			<div class="row">
				<div class="col-lg-9">
					<div class="row">
						@foreach (var p in Model.RelatedProducts)
						{
							var img = p.ProductVariants.SelectMany(v => v.ProductImages)
							.FirstOrDefault()?.UrlImage ?? "~/img/logo_team.png";

							<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
								<div class="single-related-product d-flex">
									<a href="/Product/Detail/@p.ProductId">
										<img src="~/img/logo_team.png" alt="">
									</a>
									<div class="desc">
										<a href="/Product/Detail/@p.ProductId" class="title">@p.NameProduct</a>
										<div class="price">
											<h6>@string.Format("{0:N0} đ", p.ProductVariants.Min(v => v.Price))</h6>
										</div>
									</div>
								</div>
							</div>
						}
					</div>
        </div>
				<div class="col-lg-3">
          <div class="ctg-right">
            <a href="#" target="_blank">
              <img class="img-fluid d-block mx-auto" src="../../../img/categories/c5.jpg" alt="">
            </a>
          </div>
        </div>
			</div>
		}
		else
		{
			<p class="text-center">Không có sản phẩm liên quan</p>
		}
	</div>
</section>

<section class="related-product-area section_gap py-2">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-lg-6 text-center">
				<div class="section-title">
					<h1>Sản phẩm bạn yêu thích</h1>
				</div>
			</div>
		</div>

		@if (Model.WishlistProducts?.Any() ?? false)
		{
			<div class="row">
				@foreach (var p in Model.WishlistProducts)
				{
					var price = p.ProductVariants.Min(v => v.Price);
					<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
						<div class="single-related-product d-flex">
							<a href="/Product/Detail/@p.ProductId">
								<img src="~/img/logo_team.png" />
							</a>
							<div class="desc">
								<a href="/Product/Detail/@p.ProductId" class="title">@p.NameProduct</a>
								<div class="price">
									<h6>@string.Format("{0:N0} đ", price)</h6>
								</div>
							</div>
						</div>
					</div>
				}
			</div>
		}
		else
		{
			<p class="text-center">Hãy bấm ❤️ để thêm sản phẩm yêu thích</p>
		}
	</div>
</section>
<div id="clock"></div>
<!-- End related-product Area -->
<script src="~/js/variant_select.js"></script>




